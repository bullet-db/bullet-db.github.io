<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The full documentation for Bullet - A Real Time Data Query Engine"> 
    <meta name="author" content="Akshai Sarma"> 
    <link rel="canonical" href="https://yahoo.github.io/bullet-docs/pubsub/rest/"> 
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>REST - Bullet Docs</title>

    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/extra.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    

    
    
      
    
    
    <style>
        /* Collapse ToC */
        .bs-sidebar .nav .nav {
            display: none;
        }
    </style>
    
</head>

<body data-spy="scroll" data-target=".bs-sidebar">

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Bullet Docs<small class="small small-brand-text">v0.4.0</small></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Quick Start <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../quick-start/bullet-on-spark/">Bullet On Spark</a>
</li>

                        
                            
<li >
    <a href="../../quick-start/bullet-on-storm/">Bullet On Storm</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Backend <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../backend/ingestion/">Getting your data into Bullet</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Storm</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../backend/storm-architecture/">Architecture</a>
</li>

        
            
<li >
    <a href="../../backend/storm-setup/">Setup</a>
</li>

        
            
<li >
    <a href="../../backend/storm-performance/">Performance</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Spark</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../backend/spark-architecture/">Architecture</a>
</li>

        
            
<li >
    <a href="../../backend/spark-setup/">Setup</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">PubSub <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../architecture/">Architecture</a>
</li>

                        
                            
<li >
    <a href="../kafka/">Kafka</a>
</li>

                        
                            
<li >
    <a href="../storm-drpc/">Storm DRPC</a>
</li>

                        
                            
<li class="active">
    <a href="./">REST</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Web Service <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../ws/setup/">Setup</a>
</li>

                        
                            
<li >
    <a href="../../ws/api/">API</a>
</li>

                        
                            
<li >
    <a href="../../ws/query-examples/">Query Examples</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">UI <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../ui/setup/">Setup</a>
</li>

                        
                            
<li >
    <a href="../../ui/usage/">Usage</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../releases/">Releases</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>

                        
                            
<li >
    <a href="../../about/contact/">Contact Us</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i> Search
                        </a>
                  </li>
                
                
                    <li >
                        <a rel="next" href="../storm-drpc/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../ws/setup/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3">

  

<div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="active">
            <a href="#rest-pubsub">REST PubSub</a>
            <ul class="nav">
                
                    <li class="second-level">
                        <a href="#how-does-it-work">How does it work?</a>
                        
                    </li>
            
                    <li class="second-level">
                        <a href="#setup">Setup</a>
                        <ul class="nav">
                        
                            <li class="third-level">
                                <a href="#plug-into-the-backend">Plug into the Backend</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#plug-into-the-web-service">Plug into the Web Service</a>
                                
                            </li>
                        
                        </ul>
                    </li>
            
            </ul>
        </li>
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="rest-pubsub">REST PubSub</h1>
<p>The REST PubSub implementation is included in bullet-core, and can be launched along with the Web Service. If it is enabled the Web Service will expose two additional REST endpoints, one for reading/writing Bullet queries, and one
for reading/writing results.</p>
<h2 id="how-does-it-work">How does it work?</h2>
<p>When the Web Service receives a query from a user, it will create a PubSubMessage and write the message to the "query" RESTPubSub endpoint. This PubSubMessage will contain not only the query, but also some metadata, including the
appropriate host/port to which the response should be sent (this is done to allow for multiple Web Services running simultaneously). The query is then stored in memory until the backend does a GET from this endpoint, at which
time the query will be served to the backend, and dropped from the queue in memory.</p>
<p>Once the backed has generated the results of the query, it will wrap those results in PubSubMessage. The backend extracts the URL to send the results to from the metadata and writes the results PubSubMessage to the
"results" REST endpoint with a POST. This result will then be stored in memory until the Web Service does a GET to that endpoint, at which time the Web Service will have the results of the query to send back to the user.</p>
<h2 id="setup">Setup</h2>
<p>To enable the RESTPubSub and expose the two additional necessary REST endpoints, you must enable the setting:</p>
<pre><code class="yaml">bullet.pubsub.builtin.rest.enabled: true
</code></pre>

<p>...in the Web Service Application.yaml file. This can also be done from the command line when launching the Web Service jar file by adding the command-line option:</p>
<pre><code class="bash">--bullet.pubsub.builtin.rest.enabled=true
</code></pre>

<p>This will enable the two necessary REST endpoints, the paths for which can be configured in the Application.yaml file with the settings:</p>
<pre><code class="yaml">bullet.pubsub.builtin.rest.query.path: /pubsub/query
bullet.pubsub.builtin.rest.result.path: /pubsub/result
</code></pre>

<h3 id="plug-into-the-backend">Plug into the Backend</h3>
<p>Configure the backend to use the REST PubSub:</p>
<pre><code class="yaml">bullet.pubsub.context.name: &quot;QUERY_PROCESSING&quot;
bullet.pubsub.class.name: &quot;com.yahoo.bullet.kafka.KafkaPubSub&quot;

bullet.pubsub.rest.connect.timeout.ms: 5000
bullet.pubsub.rest.subscriber.max.uncommitted.messages: 100
bullet.pubsub.rest.result.subscriber.min.wait.ms: 10
bullet.pubsub.rest.query.subscriber.min.wait.ms: 10
bullet.pubsub.rest.query.urls:
    - &quot;http://webServiceHostNameA:9901/api/bullet/pubsub/query&quot;
    - &quot;http://webServiceHostNameB:9902/api/bullet/pubsub/query&quot;
</code></pre>

<ul>
<li><strong>bullet.pubsub.context.name: "QUERY_PROCESSING"</strong> - tells the PubSub that it is running in the backend</li>
<li><strong>bullet.pubsub.class.name: "com.yahoo.bullet.kafka.KafkaPubSub"</strong> - tells Bullet to use this class for it's PubSub</li>
<li><strong>bullet.pubsub.rest.connect.timeout.ms: 5000</strong> - sets the HTTP connect timeout to a half second</li>
<li><strong>bullet.pubsub.rest.subscriber.max.uncommitted.messages: 100</strong> - this is the maxiumum number of uncommitted messages allowed before blocking</li>
<li><strong>bullet.pubsub.rest.query.subscriber.min.wait.ms: 10</strong> - this setting is used to avoid making an http request too rapidly and overloading the http endpoint. It will force the backend to poll the query endpoint at most once every 10ms.</li>
<li><strong>bullet.pubsub.rest.query.urls</strong> - this should be a list of all the query rest enpoint URLs. If you are only running one Web Service this will only contain one url (the url of your Web Service followed by the full path of the query endpoint).</li>
</ul>
<h3 id="plug-into-the-web-service">Plug into the Web Service</h3>
<p>Configure the Web Service to use the REST PubSub:</p>
<pre><code class="yaml">bullet.pubsub.context.name: &quot;QUERY_SUBMISSION&quot;
bullet.pubsub.class.name: &quot;com.yahoo.bullet.kafka.KafkaPubSub&quot;

bullet.pubsub.rest.connect.timeout.ms: 5000
bullet.pubsub.rest.subscriber.max.uncommitted.messages: 100
bullet.pubsub.rest.result.subscriber.min.wait.ms: 10
bullet.pubsub.rest.query.subscriber.min.wait.ms: 10
bullet.pubsub.rest.result.url: &quot;http://localhost:9901/api/bullet/pubsub/result&quot;
bullet.pubsub.rest.query.urls:
    - &quot;http://localhost:9901/api/bullet/pubsub/query&quot;
</code></pre>

<ul>
<li><strong>bullet.pubsub.context.name: "QUERY_SUBMISSION"</strong> - tells the PubSub that it is running in the Web Service</li>
<li><strong>bullet.pubsub.class.name: "com.yahoo.bullet.kafka.KafkaPubSub"</strong> - tells Bullet to use this class for it's PubSub</li>
<li><strong>bullet.pubsub.rest.connect.timeout.ms: 5000</strong> - sets the HTTP connect timeout to a half second</li>
<li><strong>bullet.pubsub.rest.subscriber.max.uncommitted.messages: 100</strong> - this is the maxiumum number of uncommitted messages allowed before blocking</li>
<li><strong>bullet.pubsub.rest.query.subscriber.min.wait.ms: 10</strong> - this setting is used to avoid making an http request too rapidly and overloading the http endpoint. It will force the backend to poll the query endpoint at most once every 10ms.</li>
<li><strong>bullet.pubsub.rest.result.url: "http://localhost:9901/api/bullet/pubsub/result"</strong> - this is the endpoint from which the WebService should read results - it should generally be the hostname of that machine the Web Service is running on (or "localhost").</li>
<li><strong>bullet.pubsub.rest.query.urls</strong> - in the Web Service this setting should contain <strong>exactly one</strong> url - the url to which queries should be written  - it should generally be the hostname of that machine the Web Service is running on (or "localhost").</li>
</ul></div>
        
    </div>

    <footer class="col-md-12" >
        <hr />
        <div class="pull-left col-md-6">
            
            
        </div>
        <div class="pull-right col-md-4 text-right">
            <p>
            <small>Bullet is licensed under the <a href='https://github.com/yahoo/bullet/blob/master/LICENSE'>Apache 2 license<br></small>
            
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
        </div>
    </footer>

    <script src="../../js/jquery-1.10.2.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../..';
    </script>
    <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
    <script src="../../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
