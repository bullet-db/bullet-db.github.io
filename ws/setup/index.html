<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The full documentation for Bullet - A Real Time Data Query Engine"> 
    <meta name="author" content="Akshai Sarma"> 
    <link rel="canonical" href="https://bullet-db.github.io/ws/setup/"> 
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>Setup - Bullet Docs</title>

    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/extra.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    

    
    
      
    
    
    <style>
        /* Collapse ToC */
        .bs-sidebar .nav .nav {
            display: none;
        }
    </style>
    
</head>

<body data-spy="scroll" data-target=".bs-sidebar">

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Bullet Docs<small class="small small-brand-text">v0.5.2</small></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Quick Start <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../quick-start/spark/">Spark</a>
</li>

                        
                            
<li >
    <a href="../../quick-start/storm/">Storm</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Backend <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../backend/ingestion/">Getting your data into Bullet</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Storm</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../backend/storm-architecture/">Architecture</a>
</li>

        
            
<li >
    <a href="../../backend/storm-setup/">Setup</a>
</li>

        
            
<li >
    <a href="../../backend/storm-performance/">Performance</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Spark</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../backend/spark-architecture/">Architecture</a>
</li>

        
            
<li >
    <a href="../../backend/spark-setup/">Setup</a>
</li>

        
            
<li >
    <a href="../../backend/spark-performance/">Performance</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">PubSub <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../pubsub/architecture/">Architecture</a>
</li>

                        
                            
<li >
    <a href="../../pubsub/kafka/">Kafka</a>
</li>

                        
                            
<li >
    <a href="../../pubsub/rest/">REST</a>
</li>

                        
                            
<li >
    <a href="../../pubsub/storm-drpc/">Storm DRPC</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Web Service <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li class="active">
    <a href="./">Setup</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">API</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../api-json/">JSON</a>
</li>

        
            
<li >
    <a href="../api-bql/">BQL</a>
</li>

        
    </ul>
  </li>

                        
                            
<li >
    <a href="../examples/">Query Examples</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">UI <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../ui/setup/">Setup</a>
</li>

                        
                            
<li >
    <a href="../../ui/usage/">Usage</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../releases/">Releases</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>

                        
                            
<li >
    <a href="../../about/contact/">Contact Us</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i> Search
                        </a>
                  </li>
                
                
                    <li >
                        <a rel="next" href="../../pubsub/storm-drpc/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../api-json/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/bullet-db">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3">

  

<div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="active">
            <a href="#the-web-service">The Web Service</a>
            <ul class="nav">
                
                    <li class="second-level">
                        <a href="#prerequisites">Prerequisites</a>
                        
                    </li>
            
                    <li class="second-level">
                        <a href="#installation">Installation</a>
                        
                    </li>
            
                    <li class="second-level">
                        <a href="#configuration">Configuration</a>
                        <ul class="nav">
                        
                            <li class="third-level">
                                <a href="#web-service-configuration">Web Service Configuration</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#pubsub-configuration">PubSub Configuration</a>
                                
                            </li>
                        
                        </ul>
                    </li>
            
                    <li class="second-level">
                        <a href="#launch">Launch</a>
                        
                    </li>
            
                    <li class="second-level">
                        <a href="#usage">Usage</a>
                        
                    </li>
            
            </ul>
        </li>
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="the-web-service">The Web Service</h1>
<p>The Web Service is a Java JAR file that you can deploy on a machine to communicate with the Bullet Backend. You then plug in a particular Bullet PubSub implementation such as <a href="../../pubsub/kafka/">Kafka PubSub</a> or <a href="../../pubsub/storm-drpc/">Storm DRPC PubSub</a>. For an example on how to set up a Bullet backend, see the <a href="../../backend/storm-setup/">Storm example setup</a>.</p>
<p>There are two main purposes for this layer at this time:</p>
<p>1) It provides an endpoint that can serve a <a href="http://jsonapi.org/format/">JSON API schema</a> for the Bullet UI. Currently, static schemas from a file are supported.</p>
<p>2) It generates unique identifiers and other metadata for a JSON Bullet query before sending the query to the Bullet backend. It wraps errors if the backend is unreachable.</p>
<div class="admonition note">
<p class="admonition-title">That's it?</p>
<p>The Web Service essentially just wraps the PubSub layer and provides some helpful endpoints. When incremental updates drop, it will translate a PubSub's streaming responses back into incremental results for the user. It is also there to be a point of abstraction for implementing things like security, monitoring, access-control, rate-limiting, sharding, different query formats (e.g. SQL Bullet queries) etc, which are planned in the near future.</p>
</div>
<h2 id="prerequisites">Prerequisites</h2>
<p>In order for your Web Service to work with Bullet, you should have an instance of the Backend such as <a href="../../backend/storm-setup/">Storm</a> and a PubSub instance such as <a href="../../pubsub/storm-drpc/#setup">Storm DRPC</a> or <a href="../../pubsub/kafka/#setup">Kafka</a> already set up. Alternitively you can run the RESTPubSub as part of the web service. See <a href="../../pubsub/rest/">RESTPubSub</a> for more info.</p>
<h2 id="installation">Installation</h2>
<p>You can download the JAR file directly from <a href="http://jcenter.bintray.com/com/yahoo/bullet/bullet-service/">JCenter</a>. The Web Service is a <a href="https://projects.spring.io/spring-boot/">Spring Boot</a> application. It executes as a standalone application. Note that prior to version 0.1.1, bullet-service was a WAR file that you deployed onto a servlet container like Jetty. It now embeds a <a href="http://tomcat.apache.org/">Apache Tomcat</a> servlet container.</p>
<p>If you need to depend on the source code directly (to add new endpoints for your own purposes or to build a WAR file out of the JAR), you need to add the JCenter repository and get the artifact through your dependency management system. Maven is shown below.</p>
<pre><code class="xml">&lt;repositories&gt;
    &lt;repository&gt;
        &lt;snapshots&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;
        &lt;/snapshots&gt;
        &lt;id&gt;central&lt;/id&gt;
        &lt;name&gt;bintray&lt;/name&gt;
        &lt;url&gt;http://jcenter.bintray.com&lt;/url&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;
</code></pre>

<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.yahoo.bullet&lt;/groupId&gt;
  &lt;artifactId&gt;bullet-service&lt;/artifactId&gt;
  &lt;version&gt;${bullet.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<p>You can also add <code>&lt;classifier&gt;sources&lt;/classifier&gt;</code>  or <code>&lt;classifier&gt;javadoc&lt;/classifier&gt;</code> if you want the source or javadoc or <code>&lt;classifier&gt;embedded&lt;/classifier&gt;</code> if you want the full JAR with the embedded web server.</p>
<h2 id="configuration">Configuration</h2>
<p>There are two levels of configuration:</p>
<ol>
<li>You can configure the Web Service, the web server and other Spring Boot settings through a configuration file (or through the command line when launching). By default, this file is called <code>application.yaml</code>. This is where settings like where to find your schema file (optional for if you want to power the <a href="../../ui/usage/">UI</a> schema with a static file) or how many publishers and subscribers to use for your PubSub etc.</li>
<li>You can configure what PubSub to use, the various settings for it through another configuration file. The location for this file is provided in the Web Service configuration step above.</li>
</ol>
<h3 id="web-service-configuration">Web Service Configuration</h3>
<p>Take a look at the <a href="https://github.com/bullet-db/bullet-service/blob/master/src/main/resources/application.yaml">settings</a> for a list of the settings that are configured. The Web Service settings start with <code>bullet.</code>.</p>
<p>If you provide a custom settings <code>application.yaml</code>, you will <strong>need</strong> to specify the default values in this file since the framework uses your file instead of these defaults.</p>
<h4 id="file-based-schema">File based schema</h4>
<p>The Web Service can also provide a endpoint that serves your data schema to your UI. You do not necessarily have to use this to serve your schema. The UI can use any JSON API schema specification. But if your schema is fixed or does not change often, it might be simpler for you to use this endpoint to provide the schema for the UI, instead of creating a new one. The Web Service also takes care to provide the right <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">CORS</a> headers so that your UI can communicate with it.</p>
<p>You can use <a href="https://github.com/bullet-db/bullet-service/blob/master/src/main/resources/sample_columns.json">sample_columns.json</a> as a guideline for what your actual schema file should look like or if you want to create your own Web Service that dynamically serves your schema to the UI if it changes frequently.</p>
<p>Once you have your schema file, you can provide it to the Web Service by setting the <code>bullet.schema.file</code> to the path to your file.</p>
<h4 id="spring-boot-configuration">Spring Boot Configuration</h4>
<p>You can also configure various Spring and web server here. Take a look at <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html">this page</a> page for the various values you can supply.</p>
<h3 id="pubsub-configuration">PubSub Configuration</h3>
<p>You configure the PubSub by providing a configuration YAML file and setting the <code>bullet.pubsub.config</code> to its path. In <em>that</em> file, you will set these two settings at a minimum:</p>
<ol>
<li><code>bullet.pubsub.class.name</code> should be set to the fully qualified package to your PubSub implementation. Example: <code>com.yahoo.bullet.kafka.KafkaPubSub</code> for the <a href="../../pubsub/kafka/">Kafka PubSub</a>.</li>
<li><code>bullet.pubsub.context.name: QUERY_SUBMISSION</code>. The Web Service requires the PubSub to be in the <code>QUERY_SUBMISSION</code> context.</li>
</ol>
<p>You will also specify other parameters that your chosen PubSub requires or can use.</p>
<h2 id="launch">Launch</h2>
<p>To launch, you will need your PubSub implementation JAR file and launch the application by providing the path to it. For example, if you only wished to provide the PubSub configuration and you had the Web Service jar and your chosen PubSub (say Kafka) in your current directory, you would run:</p>
<pre><code class="bash">java -Dloader.path=bullet-kafka.jar -jar bullet-service.jar --bullet.pubsub.config=pubsub_settings.yaml  --logging.level.root=INFO
</code></pre>

<p>This launches the Web Service using Kafka as the PubSub, no custom schema (the default sample columns) and the default values in <a href="https://github.com/bullet-db/bullet-service/blob/master/src/main/resources/application.yaml">settings</a>. It also uses a root logging level of <code>INFO</code>.</p>
<p>You could also tweak the various Bullet Web Service or Spring Boot settings by passing them in to the command above. For instance, you could also provide a path to your schema file using <code>--bullet.schema.file=/path/to/schema.json</code>. You could also have a custom <code>application.yaml</code> file (you can change the name using <code>spring.config.name</code>) and pass it to the Web Service instead by running:</p>
<pre><code class="bash">java -Dloader.path=bullet-kafka.jar -jar bullet-service.jar --spring.config.location=application.yaml
</code></pre>

<h2 id="usage">Usage</h2>
<p>Once the Web Service is up, you should be able to test to see if it's able to talk to the Bullet Backend:</p>
<p>You can HTTP POST a Bullet query to the API with:</p>
<pre><code class="bash">curl -s -H &quot;Content-Type: text/plain&quot; -X POST -d '{}' http://localhost:5555/api/bullet/query
</code></pre>

<p>You should receive a random record flowing through Bullet instantly (if you left the Raw aggregation micro-batch size at the default of 1 when launching the Bullet Backend).</p>
<div class="admonition note">
<p class="admonition-title">Context Path</p>
<p>The context path, or "/api/bullet" in the URL above can be changed using the Spring Boot setting <code>server.context-path</code>. You can also change the port (defaults to port 5555) using <code>server.port</code>.</p>
</div>
<p>If you provided a path to a schema file in your configuration file when you <a href="#launch">launch</a> the Web Service, you can also HTTP GET your schema at <code>http://localhost:5555/api/bullet/columns</code></p>
<p>If you did not, the schema in <a href="https://github.com/bullet-db/bullet-service/blob/master/src/main/resources/sample_columns.json">sample_columns.json</a> is the response. The Web Service converts it to a JSON API response and provides the right headers for CORS.</p></div>
        
    </div>

    <footer class="col-md-12" >
        <hr />
        <div class="pull-left col-md-6">
            
            
        </div>
        <div class="pull-right col-md-4 text-right">
            <p>
            <small>Bullet is licensed under the <a href='https://github.com/bullet-db/bullet-core/blob/master/LICENSE'>Apache 2 license</a>.<br></small>
            
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
        </div>
    </footer>

    <script src="../../js/jquery-1.10.2.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../..';
    </script>
    <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
    <script src="../../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
